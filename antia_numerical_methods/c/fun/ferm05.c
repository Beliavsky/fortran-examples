/*	To calculate the Fermi integral for k=1/2 for real argument 

	Required functions : None
*/

#include <math.h>

double ferm05(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 3.302620934271337588e+00,  4.378312090750206777e+00,
                        2.999885885327892603e+00,  1.142917097324546507e+00,
                        2.435745203546323236e-01,  2.791956018125755158e-02,
                        1.574175318764382964e-03,  3.664973020658509037e-05,
                        2.346904340445329108e-07};
	double b[10] = { 8.862269254527574101e-01,  2.613543062186459172e+00,
                        3.015927137398690065e+00,  1.739227870401479058e+00,
                        5.330822697713709794e-01,  8.586264526687773647e-02,
                        6.788394858177185501e-03,  2.274054435973081876e-04,
                        2.315801842674568714e-06,  1.633085206967838891e-09};
 
	double a1[9] = { 2.966963706974223470e-01,  1.810136368787938030e-01,
                         3.209472553909511737e-02,  8.018646702814360411e-03,
                         6.211980386042466081e-04,  6.792187282517725491e-05,
                         3.535044027227577225e-06,  2.067780549030282364e-08,
                        -3.696843108869046291e-11};
	double b1[10] = { 6.780980178378758954e-01,  7.372425434166232101e-01,
                          4.502852753072012975e-01,  1.862085214442629192e-01,
                          5.519062354389068922e-02,  1.154662947767231818e-02,
                          1.709071687204553302e-03,  1.245202776657164504e-04,
                          1.282519479810464212e-05,  2.585227363626036358e-07};
 
	double a2[8] = { -5.731200755185620178e+00,  1.015080722768952764e+05,
                          8.269267895493730982e+05,  1.660227300554511680e+09,
                         -1.412551344815020252e+10,  3.238977147316021775e+12,
                         -6.400117438754161869e+13,  8.379214798647386671e+13};
	double b2[9] = {  6.666666666666671693e-01, -2.998333470070368622e+00,
                          6.766804473599422614e+04,  6.347739642090437557e+05,
                          1.107570549042908293e+09, -8.050283273382635156e+09,
                          2.148908087876750353e+12, -4.000483321273162995e+13,
                          6.575814097228241929e+12};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=(((((((b2[8]*y+b2[7])*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=(((((((a2[7]*y+a2[6])*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=pow(x,1.5)*fn/fd;
	}

	return f;
}
 
