/*	To calculate the Fermi integral for k=-1/2 for real argument

	Required functions : None
*/

#include <math.h>

double fermm05(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 3.633183036310193702e+00,  5.335383253918690131e+00,
                        4.079430052048247651e+00,  1.747906909036781697e+00,
                        4.223506094680981781e-01,  5.537045655151334865e-02,
                        3.607687989219176229e-03,  9.850347648293245268e-05,
                        7.606021916949652951e-07};
	double b[10] = { 1.772453850905514416e+00,  5.186335126437444887e+00,
                         5.926527639536391534e+00,  3.375396555770695396e+00,
                         1.017957982472663391e+00,  1.604474074050487190e-01,
                         1.230542884288290881e-02,  3.933239725620379548e-04,
                         3.650440948497754449e-06,  9.742113007928913705e-10};
 
	double a1[9] = { 2.380598901582346509e-01,  1.948363117668486933e-01,
                         3.187787885725001684e-02,  1.038176041451691336e-02,
                         9.406874895006179971e-04,  1.135842036525309239e-04,
                         7.299137534044266613e-06,  2.523032117352548804e-07,
                         9.717901643992206546e-10};
	double b1[10] = { 1.072147023123106661e+00,  9.289962788104335480e-01,
                          4.743603973028633253e-01,  1.646743468291735872e-01,
                          3.969089819062670372e-02,  6.726576928071186234e-03,
                          6.634259351526833300e-04,  6.124666031703230112e-05,
                          3.150683483005771954e-06,  4.772635816406201002e-08};
 
	double a2[9] = { 3.702223911108869908e+02,  2.598723392323324771e+05,
                         6.353495373811685919e+07,  1.458761697561901484e+10,
                         1.726490095322560109e+12,  1.400495505156701097e+14,
                         5.452693736065907221e+15,  9.561693114496315040e+16,
                         4.481875529096675825e+17};
	double b2[10] = { 2.000000000000001084e+00,  7.396223151882119455e+02,
                          5.194366313824900668e+05,  1.268547980181480670e+08,
                          2.912203205913661556e+10,  3.440740530019870938e+12,
                          2.786232053682433961e+14,  1.078287645942363898e+16,
                          1.861949241347277040e+17,  7.588754613723405446e+17};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=((((((((b2[9]*y+b2[8])*y+b2[7])*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=((((((((a2[8]*y+a2[7])*y+a2[6])*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=sqrt(x)*fn/fd;
	}

	return f;
}
