/*	To calculate the Fermi integral for k=3/2 for real argument 

	Required functions : None
*/

#include <math.h>

double ferm15(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 2.941809147359585304e+00,  3.439655290706647512e+00,
                        2.056145556774501803e+00,  6.754795354745318686e-01,
                        1.225806771429525260e-01,  1.180305150936387470e-02,
                        5.504405550395816910e-04,  1.038731891696509330e-05,
                        5.207633334112564377e-08};
	double b[10] = { 1.329340388179136083e+00,  3.675669313153495924e+00,
                        3.966435363691792986e+00,  2.134338154956892860e+00,
                        6.096513425515978847e-01,  9.154989439790675352e-02,
                        6.772074110214310551e-03,  2.144157491371981044e-04,
                        2.129135670286070096e-06,  2.031199981119644866e-09};
 
	double a1[9] = { 3.063105631929247959e-01,  1.417872685038368678e-01,
                         2.173189054734066272e-02,  3.585800707573621106e-03,
                         1.142787213662411011e-04,  8.044697088938151454e-06,
                         2.092114542066852857e-07, -1.377485462439022186e-09,
                         7.580209448549789519e-12};
	double b1[10] = { 1.152813011323656027e+00,  1.370213448778108924e+00,
                          8.771659692101539598e-01,  3.765170899492643514e-01,
                          1.157201605837170803e-01,  2.543570598918036107e-02,
                          3.877159745588877839e-03,  3.391356678944080395e-04,
                          8.185841691628457454e-06,  7.929929143423822345e-07};
 
	double a2[7] = { 4.240537001875903744e+01,  7.106121449888719194e+04,
                         2.644247492013269539e+06,  7.388974981953715144e+08,
                         8.693570648184380205e+09,  6.684422318513495811e+11,
                         2.497458768271913493e+11};
	double b2[8] = { 4.000000000000001628e-01,  1.942954910777370651e+01,
                         2.852840658155141115e+04,  1.233002624534097401e+06,
                         3.020327832136588749e+08,  5.298507021546057868e+09,
                         2.882912998045199982e+11,  1.741052221998644210e+12};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=((((((b2[7]*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=((((((a2[6]*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=pow(x,2.5)*fn/fd;
	}

	return f;
}
 
