/*	To calculate Dawson's integral */

#include <stdio.h>
#include <math.h>

double dawson(double xg);

main()
{
	int i,i1,j,k,n;
	double x,f1,f2;

	for(i1=0; i1<99; ++i1) {
		printf("type x,        (quits when x=-9999)\n");
		scanf(" %le", &x);
		if(x==-9999) return 0;

		f1=dawson(x);
		printf(" x= %e    dawson(x) = %e \n",x,f1);
	}
	return;
}


/*	To calculate the Dawson's integral for a real argument 

	Required functions : None
*/
 
#include <math.h>

double dawson(double x)

{
	double xa,y,fn,fd,f;

/*	Coefficients of rational function approximations */
	double a[9] = { 5.574810327568612837e-01,  1.480548760676749464e-01,
                        2.473412335012745505e-02,  2.885568838534784757e-03,
                        2.460310593071530085e-04,  1.551300911064284532e-05,
                        7.087756590256507931e-07,  2.179833744510066470e-08,
                        3.580284771465818339e-10};
	double b[9] = { 1.000000000000000001e+00, -1.091856339098055081e-01,
                        4.306752089643668630e-02, -1.497994816990499693e-03,
                        3.339251349042084215e-04, -1.857560947421670758e-06,
                        6.710614181693725933e-07,  4.960681954907270745e-09,
                        2.335008164471329286e-10};
 
	double a1[9] = { 6.262545365722985257e-01,  1.885254515728064716e-01,
                         3.762507762042703303e-02,  4.987142830383369467e-03,
                         6.094443149907482678e-04,  3.731642154042092311e-05,
                         4.239542422752186968e-06,  5.982569991142279706e-08,
                         1.174473438334967860e-08};
	double b1[10] = { 1.000651029373811169e+00, -4.210501168492219455e-02,
                          3.981798325257397695e-02,  1.025635538449943440e-03,
                          4.099305572015143676e-04,  1.596933865686699852e-05,
                          2.244388174606844525e-06,  3.090088866526039173e-08,
                          5.894053468010250910e-09, -1.103344321928670385e-13};
 
	double a2[8] = {-4.779664691344904517e+00,  3.275776248263644817e+00,
                        -8.957008446633805629e-01,  1.364310927775567374e-01,
                        -1.254364750946865384e-02,  7.203420550034988907e-04,
                        -2.404381247095368252e-05,  3.964910408777002362e-07};
	double b2[9] = {-1.813546033357404877e+00,  1.455784804742178438e+00,
                        -4.178728305708361334e-01,  6.532985079094380749e-02,
                        -6.100423692880221490e-03,  3.543095925141692234e-04,
                        -1.192279451351772837e-05,  1.982456062768223261e-07,
                        -2.989826117053882457e-16};
 
	double a3[7] = {-7.277595909795730480e+01,  2.030133303927516449e+03,
                        -2.623905050877405481e+04,  1.572452946972041743e+05,
                        -3.959782020608236881e+05,  3.242235333091555331e+05,
                        -3.695969139799184010e+04};
	double b3[7] = { 4.999999999999999987e-01, -3.613797954897864312e+01,
                         9.972476621892572722e+02, -1.263834541306106681e+04,
                         7.275923849721134328e+04, -1.668382015827219241e+05,
                         1.031530728542497468e+05};
 
	xa=fabs(x);
	if(xa<2.5) {
		y=x*x;
		fn=(((((((b[8]*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=x*fn/fd;
	}

	else if(xa<4.0) {
		y=x*x;
		fn=((((((((b1[9]*y+b1[8])*y+b1[7])*y+b1[6])*y+b1[5])*y+b1[4])*y+b1[3])*y+b1[2])*y+b1[1])*y+b1[0];
		fd=((((((((a1[8]*y+a1[7])*y+a1[6])*y+a1[5])*y+a1[4])*y+a1[3])*y+a1[2])*y+a1[1])*y+a1[0])*y+1;
		f=x*fn/fd;
	}

	else if(xa<5.5) {
		y=x*x;
		fn=(((((((b2[8]*y+b2[7])*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=(((((((a2[7]*y+a2[6])*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=x*fn/fd;
	}

	else {
		y=1./(x*x);
		fn=(((((b3[6]*y+b3[5])*y+b3[4])*y+b3[3])*y+b3[2])*y+b3[1])*y+b3[0];
		fd=((((((a3[6]*y+a3[5])*y+a3[4])*y+a3[3])*y+a3[2])*y+a3[1])*y+a3[0])*y+1;
		f=fn/(fd*x);
	}
	return f;
}
