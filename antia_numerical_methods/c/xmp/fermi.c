/*	To calculate Fermi integrals */

#include <stdio.h>
#include <math.h>

double fermm05(double xg);
double ferm05(double xg);
double ferm15(double xg);
double ferm25(double xg);

main()
{
	int i,i1,j,k,n;
	double x,f1,f2,f3,f4;

	for(i1=0; i1<99; ++i1) {
		printf("type x,        (quits when x=-9999)\n");
		scanf(" %le", &x);
		if(x==-9999) return 0;

		f1=fermm05(x);
		f2=ferm05(x);
		f3=ferm15(x);
		f4=ferm25(x);
		printf(" x= %e   F_(-1/2) = %e    F_1/2 = %e \n  F_3/2 = %e     F_5/2 = %e\n",x,f1,f2,f3,f4);
	}
	return;
}



/*	To calculate the Fermi integral for k=-1/2 for real argument

	Required functions : None
*/

#include <math.h>

double fermm05(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 3.633183036310193702e+00,  5.335383253918690131e+00,
                        4.079430052048247651e+00,  1.747906909036781697e+00,
                        4.223506094680981781e-01,  5.537045655151334865e-02,
                        3.607687989219176229e-03,  9.850347648293245268e-05,
                        7.606021916949652951e-07};
	double b[10] = { 1.772453850905514416e+00,  5.186335126437444887e+00,
                         5.926527639536391534e+00,  3.375396555770695396e+00,
                         1.017957982472663391e+00,  1.604474074050487190e-01,
                         1.230542884288290881e-02,  3.933239725620379548e-04,
                         3.650440948497754449e-06,  9.742113007928913705e-10};
 
	double a1[9] = { 2.380598901582346509e-01,  1.948363117668486933e-01,
                         3.187787885725001684e-02,  1.038176041451691336e-02,
                         9.406874895006179971e-04,  1.135842036525309239e-04,
                         7.299137534044266613e-06,  2.523032117352548804e-07,
                         9.717901643992206546e-10};
	double b1[10] = { 1.072147023123106661e+00,  9.289962788104335480e-01,
                          4.743603973028633253e-01,  1.646743468291735872e-01,
                          3.969089819062670372e-02,  6.726576928071186234e-03,
                          6.634259351526833300e-04,  6.124666031703230112e-05,
                          3.150683483005771954e-06,  4.772635816406201002e-08};
 
	double a2[9] = { 3.702223911108869908e+02,  2.598723392323324771e+05,
                         6.353495373811685919e+07,  1.458761697561901484e+10,
                         1.726490095322560109e+12,  1.400495505156701097e+14,
                         5.452693736065907221e+15,  9.561693114496315040e+16,
                         4.481875529096675825e+17};
	double b2[10] = { 2.000000000000001084e+00,  7.396223151882119455e+02,
                          5.194366313824900668e+05,  1.268547980181480670e+08,
                          2.912203205913661556e+10,  3.440740530019870938e+12,
                          2.786232053682433961e+14,  1.078287645942363898e+16,
                          1.861949241347277040e+17,  7.588754613723405446e+17};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=((((((((b2[9]*y+b2[8])*y+b2[7])*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=((((((((a2[8]*y+a2[7])*y+a2[6])*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=sqrt(x)*fn/fd;
	}

	return f;
}


/*	To calculate the Fermi integral for k=1/2 for real argument 

	Required functions : None
*/

#include <math.h>

double ferm05(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 3.302620934271337588e+00,  4.378312090750206777e+00,
                        2.999885885327892603e+00,  1.142917097324546507e+00,
                        2.435745203546323236e-01,  2.791956018125755158e-02,
                        1.574175318764382964e-03,  3.664973020658509037e-05,
                        2.346904340445329108e-07};
	double b[10] = { 8.862269254527574101e-01,  2.613543062186459172e+00,
                        3.015927137398690065e+00,  1.739227870401479058e+00,
                        5.330822697713709794e-01,  8.586264526687773647e-02,
                        6.788394858177185501e-03,  2.274054435973081876e-04,
                        2.315801842674568714e-06,  1.633085206967838891e-09};
 
	double a1[9] = { 2.966963706974223470e-01,  1.810136368787938030e-01,
                         3.209472553909511737e-02,  8.018646702814360411e-03,
                         6.211980386042466081e-04,  6.792187282517725491e-05,
                         3.535044027227577225e-06,  2.067780549030282364e-08,
                        -3.696843108869046291e-11};
	double b1[10] = { 6.780980178378758954e-01,  7.372425434166232101e-01,
                          4.502852753072012975e-01,  1.862085214442629192e-01,
                          5.519062354389068922e-02,  1.154662947767231818e-02,
                          1.709071687204553302e-03,  1.245202776657164504e-04,
                          1.282519479810464212e-05,  2.585227363626036358e-07};
 
	double a2[8] = { -5.731200755185620178e+00,  1.015080722768952764e+05,
                          8.269267895493730982e+05,  1.660227300554511680e+09,
                         -1.412551344815020252e+10,  3.238977147316021775e+12,
                         -6.400117438754161869e+13,  8.379214798647386671e+13};
	double b2[9] = {  6.666666666666671693e-01, -2.998333470070368622e+00,
                          6.766804473599422614e+04,  6.347739642090437557e+05,
                          1.107570549042908293e+09, -8.050283273382635156e+09,
                          2.148908087876750353e+12, -4.000483321273162995e+13,
                          6.575814097228241929e+12};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=(((((((b2[8]*y+b2[7])*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=(((((((a2[7]*y+a2[6])*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=pow(x,1.5)*fn/fd;
	}

	return f;
}
 


/*	To calculate the Fermi integral for k=3/2 for real argument 

	Required functions : None
*/

#include <math.h>

double ferm15(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 2.941809147359585304e+00,  3.439655290706647512e+00,
                        2.056145556774501803e+00,  6.754795354745318686e-01,
                        1.225806771429525260e-01,  1.180305150936387470e-02,
                        5.504405550395816910e-04,  1.038731891696509330e-05,
                        5.207633334112564377e-08};
	double b[10] = { 1.329340388179136083e+00,  3.675669313153495924e+00,
                        3.966435363691792986e+00,  2.134338154956892860e+00,
                        6.096513425515978847e-01,  9.154989439790675352e-02,
                        6.772074110214310551e-03,  2.144157491371981044e-04,
                        2.129135670286070096e-06,  2.031199981119644866e-09};
 
	double a1[9] = { 3.063105631929247959e-01,  1.417872685038368678e-01,
                         2.173189054734066272e-02,  3.585800707573621106e-03,
                         1.142787213662411011e-04,  8.044697088938151454e-06,
                         2.092114542066852857e-07, -1.377485462439022186e-09,
                         7.580209448549789519e-12};
	double b1[10] = { 1.152813011323656027e+00,  1.370213448778108924e+00,
                          8.771659692101539598e-01,  3.765170899492643514e-01,
                          1.157201605837170803e-01,  2.543570598918036107e-02,
                          3.877159745588877839e-03,  3.391356678944080395e-04,
                          8.185841691628457454e-06,  7.929929143423822345e-07};
 
	double a2[7] = { 4.240537001875903744e+01,  7.106121449888719194e+04,
                         2.644247492013269539e+06,  7.388974981953715144e+08,
                         8.693570648184380205e+09,  6.684422318513495811e+11,
                         2.497458768271913493e+11};
	double b2[8] = { 4.000000000000001628e-01,  1.942954910777370651e+01,
                         2.852840658155141115e+04,  1.233002624534097401e+06,
                         3.020327832136588749e+08,  5.298507021546057868e+09,
                         2.882912998045199982e+11,  1.741052221998644210e+12};
 
	if(x<2.0) {
		y=exp(x);
		fn=((((((((b[9]*y+b[8])*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=((((((b2[7]*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=((((((a2[6]*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=pow(x,2.5)*fn/fd;
	}

	return f;
}
 


/*	To calculate the Fermi integral for k=5/2 for real argument

	Required functions : None
*/

#include <math.h>

double ferm25(double x)

{
	double y,f,fn,fd;

/*	Coefficients of rational function approximations */
	double a[9] = { 2.571894150057574794e+00,  2.583310822362159194e+00,
                        1.297464965411635611e+00,  3.478951634872978662e-01,
                        4.953536822731509544e-02,  3.534319266081264567e-03,
                        1.114660054008188913e-04,  1.196397340523770481e-06,
                        2.108653816687462637e-09};
	double b[9] = { 3.323350970447843045e+00,  8.253561418549546218e+00,
                        7.900830547729824064e+00,  3.709901839066293724e+00,
                        9.037486960062833711e-01,  1.118605468265125269e-01,
                        6.453871643985184629e-03,  1.439223289367074978e-04,
                        7.851354785439239006e-07};
 
	double a1[9] = { 3.143350423552492924e-01,  1.185925514982136793e-01,
                         1.507118078811659113e-02,  1.570482413916096774e-03,
                        -5.595169056590362619e-05, -3.021530267629797655e-06,
                         2.935920822791014998e-08, -3.139429619713453590e-10,
                         1.862374323772158779e-12};
	double b1[10] = { 3.082574389659515354e+00,  3.851032874650932823e+00,
                          2.542778697192629395e+00,  1.123138726193956412e+00,
                          3.568215902085525392e-01,  8.321216695003629528e-02,
                          1.368008186484687443e-02,  1.461373661943904411e-03,
                          4.840746803030768445e-05, -6.684259889599044773e-06};
 
	double a2[7] = {-1.010224365188074094e+02,  6.300193167257369564e+04,
                        -2.611825140904720814e+06,  6.096057209422390797e+08,
                        -1.021314648072490935e+10,  7.043216447315414049e+11,
                        -6.058065587728390704e+11};
	double b2[8] = { 2.857142857142856463e-01, -2.475121812396447356e+01,
                         1.758866516117776321e+04, -4.875066917911561303e+05,
                         1.636558505721404325e+08, -4.202416018195836072e+08,
                         1.613941002540396296e+11,  2.688699848072963231e+12};
 
	if(x<2.0) {
		y=exp(x);
		fn=(((((((b[8]*y+b[7])*y+b[6])*y+b[5])*y+b[4])*y+b[3])*y+b[2])*y+b[1])*y+b[0];
		fd=((((((((a[8]*y+a[7])*y+a[6])*y+a[5])*y+a[4])*y+a[3])*y+a[2])*y+a[1])*y+a[0])*y+1;
		f=y*fn/fd;
	}

	else if(x<10.0) {
		fn=((((((((b1[9]*x+b1[8])*x+b1[7])*x+b1[6])*x+b1[5])*x+b1[4])*x+b1[3])*x+b1[2])*x+b1[1])*x+b1[0];
		fd=((((((((a1[8]*x+a1[7])*x+a1[6])*x+a1[5])*x+a1[4])*x+a1[3])*x+a1[2])*x+a1[1])*x+a1[0])*x+1;
		f=fn/fd;
	}
	else {
		y=1.0/(x*x);
		fn=((((((b2[7]*y+b2[6])*y+b2[5])*y+b2[4])*y+b2[3])*y+b2[2])*y+b2[1])*y+b2[0];
		fd=((((((a2[6]*y+a2[5])*y+a2[4])*y+a2[3])*y+a2[2])*y+a2[1])*y+a2[0])*y+1;
		f=pow(x,3.5)*fn/fd;
	}

	return f;
}
