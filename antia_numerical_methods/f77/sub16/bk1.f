!	To calculate the modified Bessel function of second kind of order
!	one for real argument
!	For X<0 the function is not defined and the routine simply returns
!	a value of zero without any warning or error flag.
!
!	Required routines : None
 
      FUNCTION BK1(X)
      IMPLICIT REAL*16(A-H,O-Z)
      PARAMETER(EUGAM=0.5772156649015328606Q0)
      DIMENSION A(7),B(8),A1(5),B1(6),A0(7),B0(8)
 
!	Coefficients of rational function approximations
      DATA A/ -1.070229423222827071Q-02,  5.648033546364466297Q-05,
     1        -1.918252346392549379Q-07,  4.558004979539079070Q-10,
     1        -7.621816709677626962Q-13,  8.342527256774311367Q-16,
     1        -4.621507477175875649Q-19/
      DATA B/  4.999999999999999914Q-01,  5.714885288388592026Q-02,
     1         1.963513444884162262Q-03,  2.981702267497806226Q-05,
     1         2.328548099504502597Q-07,  9.862614413072000150Q-10,
     1         2.192079167003372805Q-12,  2.056894175269540721Q-15/
 
      DATA A0/ -1.097271232519001047Q-02,  5.948570919145243152Q-05,
     1         -2.079707688602524007Q-07,  5.097946369393536825Q-10,
     1         -8.813373771643053620Q-13,  9.993295069392185250Q-16,
     1         -5.743938665570093767Q-19/
      DATA B0/  2.499999999999999663Q-01,  7.538182191870271423Q-02,
     1          3.497906054669938529Q-03,  6.321709197334740028Q-05,
     1          5.569209160486120478Q-07,  2.585145364373725340Q-09,
     1          6.185681870407510042Q-12,  6.175435537988524458Q-15/
 
      DATA A1/  9.546087640477785968Q+00,  2.842458429353285707Q+01,
     1          3.039341689594721892Q+01,  9.857685145186666128Q+00,
     1          4.376813258161116587Q-01/
      DATA B1/  1.253314137315500259Q+00,  1.243423939735687111Q+01,
     1          3.996465306538935273Q+01,  5.017830258820480688Q+01,
     1          2.351074680068346432Q+01,  2.993271886379231231Q+00/
 
      BK1=0.0
      IF(X.LE.0.0) RETURN
      IF(X.LT.8.0) THEN
!	Use rational function approximation
        Y=X*X
        FN=((((((B(8)*Y+B(7))*Y+B(6))*Y+B(5))*Y+B(4))*Y+B(3))*Y+B(2))*Y
     1      +B(1)
        FD=((((((A(7)*Y+A(6))*Y+A(5))*Y+A(4))*Y+A(3))*Y+A(2))*Y+A(1))*Y
     1      +1
 
        BI1=X*FN/FD
        FN=((((((B0(8)*Y+B0(7))*Y+B0(6))*Y+B0(5))*Y+B0(4))*Y+B0(3))*Y
     1      +B0(2))*Y+B0(1)
        FD=((((((A0(7)*Y+A0(6))*Y+A0(5))*Y+A0(4))*Y+A0(3))*Y+A0(2))*Y
     1      +A0(1))*Y+1
        BK1=-X*FN/FD+BI1*(EUGAM+LOG(X/2))+1./X
 
      ELSE
!	Use rational function approximation to the asymptotic form
        X1=1./X
        FN=((((B1(6)*X1+B1(5))*X1+B1(4))*X1+B1(3))*X1+B1(2))*X1+B1(1)
        FD=((((A1(5)*X1+A1(4))*X1+A1(3))*X1+A1(2))*X1+A1(1))*X1+1
        BK1=EXP(-X)*FN/(FD*SQRT(X))
      ENDIF
 
      END
